dashboards:
  AWS-WAF-FOR-EVENT-ANALYSIS:
    dependsOn:
      datasets:
      - waf_logs_antiddos_least_fields_v2
    name: AWS-WAF-For-Event-ANalysis
    dashboardId: aws-waf-for-event-analysis
    data: |-
      AnalysisDefaults:
        DefaultNewSheetConfiguration:
          InteractiveLayoutConfiguration:
            Grid:
              CanvasSizeOptions:
                ScreenCanvasSizeOptions:
                  OptimizedViewPortWidth: 1600px
                  ResizeOption: FIXED
          SheetContentType: INTERACTIVE
      CalculatedFields:
      - DataSetIdentifier: waf_logs_antiddos_least_fields_v2
        Expression: parseDate(concat(year, '-', month, '-', day, ' ', hour, ':',minute,
          ':00'), 'yyyy-MM-dd HH:mm:ss')
        Name: date_range
      DataSetIdentifierDeclarations:
      - DataSetArn: arn:aws:quicksight:::dataset/612def5a-b103-4e4d-8c04-a027e6fbe124
        Identifier: waf_logs_antiddos_least_fields_v2
      FilterGroups:
      - CrossDataset: SINGLE_DATASET
        FilterGroupId: c581897e-8f14-4c8d-9a11-179533776743
        Filters:
        - TimeRangeFilter:
            Column:
              ColumnName: date_range
              DataSetIdentifier: waf_logs_antiddos_least_fields_v2
            FilterId: ad53b3c6-89c7-4b7f-a263-1e9f6f7520cb
            IncludeMaximum: true
            IncludeMinimum: true
            NullOption: NON_NULLS_ONLY
            RangeMaximumValue:
              Parameter: DataToAnalyzeEnd
            RangeMinimumValue:
              Parameter: DataToAnalyzeStart
            TimeGranularity: DAY
        ScopeConfiguration:
          SelectedSheets:
            SheetVisualScopingConfigurations:
            - Scope: SELECTED_VISUALS
              SheetId: f55c69b0-fdc6-4525-a2ae-ad14e397f41b
              VisualIds:
              - 7599e3ca-56c4-4a4d-b638-c0232178b241
              - c812ce89-0479-4f0d-8889-01448c0e83ab
              - 928fc55a-b922-49d3-8cc0-6d605f52bda3
        Status: ENABLED
      - CrossDataset: SINGLE_DATASET
        FilterGroupId: 3f1e94f4-8665-469f-9763-f5bc08c838f7
        Filters:
        - TimeRangeFilter:
            Column:
              ColumnName: date_range
              DataSetIdentifier: waf_logs_antiddos_least_fields_v2
            FilterId: 6ea08b99-f03e-40ca-ba93-e06188438dfe
            IncludeMaximum: true
            IncludeMinimum: true
            NullOption: NON_NULLS_ONLY
            RangeMaximumValue:
              Parameter: BaseLineEnd
            RangeMinimumValue:
              Parameter: BaseLineStart
            TimeGranularity: DAY
        ScopeConfiguration:
          SelectedSheets:
            SheetVisualScopingConfigurations:
            - Scope: SELECTED_VISUALS
              SheetId: e5f34929-f856-45df-a4bd-25ffb3a7fb66
              VisualIds:
              - 6fa80101-2c15-4d90-8052-629cf63a7528
        Status: ENABLED
      - CrossDataset: SINGLE_DATASET
        FilterGroupId: d50932c7-91f6-4b72-ba6c-f61e31d9cc7b
        Filters:
        - CategoryFilter:
            Column:
              ColumnName: account_id
              DataSetIdentifier: waf_logs_antiddos_least_fields_v2
            Configuration:
              CustomFilterConfiguration:
                MatchOperator: EQUALS
                NullOption: NON_NULLS_ONLY
                ParameterName: AccountID
            FilterId: 38871d24-6bb4-4776-a53f-f1fd9794a062
        ScopeConfiguration:
          SelectedSheets:
            SheetVisualScopingConfigurations:
            - Scope: ALL_VISUALS
              SheetId: e5f34929-f856-45df-a4bd-25ffb3a7fb66
        Status: ENABLED
      - CrossDataset: SINGLE_DATASET
        FilterGroupId: 64cdd462-3b1e-4a06-beb3-ce9fe7bbacf3
        Filters:
        - TimeRangeFilter:
            Column:
              ColumnName: date_range
              DataSetIdentifier: waf_logs_antiddos_least_fields_v2
            FilterId: 32cd2167-65a8-435f-9b4f-89374c70bb82
            IncludeMaximum: true
            IncludeMinimum: true
            NullOption: NON_NULLS_ONLY
            RangeMaximumValue:
              Parameter: EventEnd
            RangeMinimumValue:
              Parameter: EventStart
            TimeGranularity: DAY
        ScopeConfiguration:
          SelectedSheets:
            SheetVisualScopingConfigurations:
            - Scope: SELECTED_VISUALS
              SheetId: e5f34929-f856-45df-a4bd-25ffb3a7fb66
              VisualIds:
              - 9e5ee902-fcb3-468d-b7a7-67ea822e7b9e
        Status: ENABLED
      - CrossDataset: SINGLE_DATASET
        FilterGroupId: 1ed2b7e8-567c-4ec1-8643-8b7811ce5b91
        Filters:
        - TimeRangeFilter:
            Column:
              ColumnName: date_range
              DataSetIdentifier: waf_logs_antiddos_least_fields_v2
            FilterId: 2d76b301-00da-460f-9ce7-f09005121389
            IncludeMaximum: true
            IncludeMinimum: true
            NullOption: NON_NULLS_ONLY
            RangeMaximumValue:
              Parameter: BaseLineEnd
            RangeMinimumValue:
              Parameter: BaseLineStart
            TimeGranularity: DAY
        ScopeConfiguration:
          SelectedSheets:
            SheetVisualScopingConfigurations:
            - Scope: SELECTED_VISUALS
              SheetId: e5f34929-f856-45df-a4bd-25ffb3a7fb66
              VisualIds:
              - 988d27b1-b21d-4c4e-a8a5-8983e3502643
              - d80b8168-75b0-48d6-9500-a8ee51fd8dfc
        Status: ENABLED
      - CrossDataset: SINGLE_DATASET
        FilterGroupId: a6a08bbb-02d8-474a-8064-d50a04fa11d1
        Filters:
        - TimeRangeFilter:
            Column:
              ColumnName: date_range
              DataSetIdentifier: waf_logs_antiddos_least_fields_v2
            FilterId: 33485ee7-b87b-40f3-b0cb-f018154cf410
            IncludeMaximum: true
            IncludeMinimum: true
            NullOption: NON_NULLS_ONLY
            RangeMaximumValue:
              Parameter: EventEnd
            RangeMinimumValue:
              Parameter: EventStart
            TimeGranularity: DAY
        ScopeConfiguration:
          SelectedSheets:
            SheetVisualScopingConfigurations:
            - Scope: SELECTED_VISUALS
              SheetId: e5f34929-f856-45df-a4bd-25ffb3a7fb66
              VisualIds:
              - db25c602-1c14-435d-9e64-1d3ac58bad41
              - bc1a6524-92ea-4f11-b4e4-5f84f665ef4f
        Status: ENABLED
      - CrossDataset: SINGLE_DATASET
        FilterGroupId: 18f33731-6de1-4b63-9795-7da84f174973
        Filters:
        - TimeRangeFilter:
            Column:
              ColumnName: date_range
              DataSetIdentifier: waf_logs_antiddos_least_fields_v2
            FilterId: 11526100-3aff-4f51-9300-619ebe84cdb2
            IncludeMaximum: true
            IncludeMinimum: true
            NullOption: NON_NULLS_ONLY
            RangeMaximumValue:
              Parameter: BaseLineEnd
            RangeMinimumValue:
              Parameter: BaseLineStart
            TimeGranularity: DAY
        ScopeConfiguration:
          SelectedSheets:
            SheetVisualScopingConfigurations:
            - Scope: SELECTED_VISUALS
              SheetId: 43b25c81-6789-49bd-bf7a-332b34aeefc9
              VisualIds:
              - 19faa481-7324-4dd7-a40e-f6108c662bf2
        Status: ENABLED
      - CrossDataset: SINGLE_DATASET
        FilterGroupId: f77d7ecf-a3cf-483e-859e-af87572148f3
        Filters:
        - CategoryFilter:
            Column:
              ColumnName: account_id
              DataSetIdentifier: waf_logs_antiddos_least_fields_v2
            Configuration:
              CustomFilterConfiguration:
                MatchOperator: EQUALS
                NullOption: NON_NULLS_ONLY
                ParameterName: AccountID
            FilterId: 4556b8b1-811b-4ba6-9b06-59709c6b9ae8
        ScopeConfiguration:
          SelectedSheets:
            SheetVisualScopingConfigurations:
            - Scope: ALL_VISUALS
              SheetId: 43b25c81-6789-49bd-bf7a-332b34aeefc9
        Status: ENABLED
      - CrossDataset: SINGLE_DATASET
        FilterGroupId: 82f9d92f-e1ea-41f5-b051-10eec81e3d59
        Filters:
        - TimeRangeFilter:
            Column:
              ColumnName: date_range
              DataSetIdentifier: waf_logs_antiddos_least_fields_v2
            FilterId: b562938f-4571-454b-b8a5-95a79b4111dd
            IncludeMaximum: true
            IncludeMinimum: true
            NullOption: NON_NULLS_ONLY
            RangeMaximumValue:
              Parameter: EventEnd
            RangeMinimumValue:
              Parameter: EventStart
            TimeGranularity: DAY
        ScopeConfiguration:
          SelectedSheets:
            SheetVisualScopingConfigurations:
            - Scope: SELECTED_VISUALS
              SheetId: 43b25c81-6789-49bd-bf7a-332b34aeefc9
              VisualIds:
              - 707522af-7cc8-4831-bf16-cadc910bfd93
        Status: ENABLED
      - CrossDataset: SINGLE_DATASET
        FilterGroupId: 40fd780e-f7b0-4e8f-a925-9fbce54209a3
        Filters:
        - TimeRangeFilter:
            Column:
              ColumnName: date_range
              DataSetIdentifier: waf_logs_antiddos_least_fields_v2
            FilterId: 651778f4-40a7-4142-a816-89b51f36ab94
            IncludeMaximum: true
            IncludeMinimum: true
            NullOption: NON_NULLS_ONLY
            RangeMaximumValue:
              Parameter: BaseLineEnd
            RangeMinimumValue:
              Parameter: BaseLineStart
            TimeGranularity: DAY
        ScopeConfiguration:
          SelectedSheets:
            SheetVisualScopingConfigurations:
            - Scope: SELECTED_VISUALS
              SheetId: 43b25c81-6789-49bd-bf7a-332b34aeefc9
              VisualIds:
              - f610f253-ecdd-4a90-ae9f-1b7ba4a88750
        Status: ENABLED
      - CrossDataset: SINGLE_DATASET
        FilterGroupId: 7dce040b-2b34-4d84-8422-975277b62c78
        Filters:
        - TimeRangeFilter:
            Column:
              ColumnName: date_range
              DataSetIdentifier: waf_logs_antiddos_least_fields_v2
            FilterId: e2badde3-49f7-4c57-9186-d89ad8e556ba
            IncludeMaximum: true
            IncludeMinimum: true
            NullOption: NON_NULLS_ONLY
            RangeMaximumValue:
              Parameter: EventEnd
            RangeMinimumValue:
              Parameter: EventStart
            TimeGranularity: DAY
        ScopeConfiguration:
          SelectedSheets:
            SheetVisualScopingConfigurations:
            - Scope: SELECTED_VISUALS
              SheetId: 43b25c81-6789-49bd-bf7a-332b34aeefc9
              VisualIds:
              - a41ddd59-da43-48ce-8392-9e7f3785291f
        Status: ENABLED
      - CrossDataset: SINGLE_DATASET
        FilterGroupId: 228b4214-2b5a-412f-b4e5-03d5314f68a6
        Filters:
        - TimeRangeFilter:
            Column:
              ColumnName: date_range
              DataSetIdentifier: waf_logs_antiddos_least_fields_v2
            FilterId: f33de87c-67fe-4a3b-904b-a70d9ec64407
            IncludeMaximum: true
            IncludeMinimum: true
            NullOption: NON_NULLS_ONLY
            RangeMaximumValue:
              Parameter: BaseLineEnd
            RangeMinimumValue:
              Parameter: BaseLineStart
            TimeGranularity: DAY
        ScopeConfiguration:
          SelectedSheets:
            SheetVisualScopingConfigurations:
            - Scope: SELECTED_VISUALS
              SheetId: 84653b0c-13fc-4cf6-bef0-bbb1f840c6b7
              VisualIds:
              - 1b234605-7ad4-4c2a-9552-3f8fafaf0ace
        Status: ENABLED
      - CrossDataset: SINGLE_DATASET
        FilterGroupId: 5902e12b-9ecb-4432-8421-83576a679ef2
        Filters:
        - CategoryFilter:
            Column:
              ColumnName: account_id
              DataSetIdentifier: waf_logs_antiddos_least_fields_v2
            Configuration:
              CustomFilterConfiguration:
                MatchOperator: EQUALS
                NullOption: NON_NULLS_ONLY
                ParameterName: AccountID
            FilterId: a90c0512-d8ab-4b3f-9b6a-80991055e3ea
        ScopeConfiguration:
          SelectedSheets:
            SheetVisualScopingConfigurations:
            - Scope: ALL_VISUALS
              SheetId: 84653b0c-13fc-4cf6-bef0-bbb1f840c6b7
        Status: ENABLED
      - CrossDataset: SINGLE_DATASET
        FilterGroupId: 98bf0c47-8018-4811-adce-6502103cf06c
        Filters:
        - TimeRangeFilter:
            Column:
              ColumnName: date_range
              DataSetIdentifier: waf_logs_antiddos_least_fields_v2
            FilterId: 3b176e39-1997-4296-8149-83485dd46b52
            IncludeMaximum: true
            IncludeMinimum: true
            NullOption: NON_NULLS_ONLY
            RangeMaximumValue:
              Parameter: EventEnd
            RangeMinimumValue:
              Parameter: EventStart
            TimeGranularity: DAY
        ScopeConfiguration:
          SelectedSheets:
            SheetVisualScopingConfigurations:
            - Scope: SELECTED_VISUALS
              SheetId: 84653b0c-13fc-4cf6-bef0-bbb1f840c6b7
              VisualIds:
              - 512bdde9-4f03-436c-bbf2-de5988750035
        Status: ENABLED
      - CrossDataset: SINGLE_DATASET
        FilterGroupId: d60db9e0-fcac-4271-b122-af9b55a97832
        Filters:
        - TimeRangeFilter:
            Column:
              ColumnName: date_range
              DataSetIdentifier: waf_logs_antiddos_least_fields_v2
            FilterId: 27746bad-9f05-444f-85e6-a358ad25f548
            IncludeMaximum: true
            IncludeMinimum: true
            NullOption: NON_NULLS_ONLY
            RangeMaximumValue:
              Parameter: BaseLineEnd
            RangeMinimumValue:
              Parameter: BaseLineStart
            TimeGranularity: DAY
        ScopeConfiguration:
          SelectedSheets:
            SheetVisualScopingConfigurations:
            - Scope: SELECTED_VISUALS
              SheetId: 84653b0c-13fc-4cf6-bef0-bbb1f840c6b7
              VisualIds:
              - c9198fc5-327e-4a0f-8ac2-ffe04afb369f
        Status: ENABLED
      - CrossDataset: SINGLE_DATASET
        FilterGroupId: 578bc66f-1763-45cf-8c63-efcc4af5bcb8
        Filters:
        - TimeRangeFilter:
            Column:
              ColumnName: date_range
              DataSetIdentifier: waf_logs_antiddos_least_fields_v2
            FilterId: 3f613680-196a-4212-9f6f-08c149fa7ee2
            IncludeMaximum: true
            IncludeMinimum: true
            NullOption: NON_NULLS_ONLY
            RangeMaximumValue:
              Parameter: EventEnd
            RangeMinimumValue:
              Parameter: EventStart
            TimeGranularity: DAY
        ScopeConfiguration:
          SelectedSheets:
            SheetVisualScopingConfigurations:
            - Scope: SELECTED_VISUALS
              SheetId: 84653b0c-13fc-4cf6-bef0-bbb1f840c6b7
              VisualIds:
              - 12ea68b7-70c9-4ff8-a1a7-980d3a59d8ac
        Status: ENABLED
      - CrossDataset: SINGLE_DATASET
        FilterGroupId: a79a98ab-aff6-4674-b19a-8b7c88c9fdaa
        Filters:
        - TimeRangeFilter:
            Column:
              ColumnName: date_range
              DataSetIdentifier: waf_logs_antiddos_least_fields_v2
            FilterId: 68cd1812-6ef2-483f-87fd-55667fbd0727
            IncludeMaximum: true
            IncludeMinimum: true
            NullOption: NON_NULLS_ONLY
            RangeMaximumValue:
              Parameter: BaseLineEnd
            RangeMinimumValue:
              Parameter: BaseLineStart
            TimeGranularity: DAY
        ScopeConfiguration:
          SelectedSheets:
            SheetVisualScopingConfigurations:
            - Scope: SELECTED_VISUALS
              SheetId: 43b25c81-6789-49bd-bf7a-332b34aeefc9
              VisualIds:
              - added081-1a71-4574-8bd8-3207bb491d70
        Status: ENABLED
      - CrossDataset: SINGLE_DATASET
        FilterGroupId: 76a0e0c2-18a2-43a1-8ade-4eb9bcbf68bb
        Filters:
        - TimeRangeFilter:
            Column:
              ColumnName: date_range
              DataSetIdentifier: waf_logs_antiddos_least_fields_v2
            FilterId: b5cb0e03-7b40-4654-b97f-f188bbca30a4
            IncludeMaximum: true
            IncludeMinimum: true
            NullOption: NON_NULLS_ONLY
            RangeMaximumValue:
              Parameter: EventEnd
            RangeMinimumValue:
              Parameter: EventStart
            TimeGranularity: DAY
        ScopeConfiguration:
          SelectedSheets:
            SheetVisualScopingConfigurations:
            - Scope: SELECTED_VISUALS
              SheetId: 43b25c81-6789-49bd-bf7a-332b34aeefc9
              VisualIds:
              - a8566472-9767-4526-b795-cf7417f6ed5c
        Status: ENABLED
      - CrossDataset: SINGLE_DATASET
        FilterGroupId: 71f9b9b4-2fce-4957-9252-b8ae2cc43018
        Filters:
        - CategoryFilter:
            Column:
              ColumnName: account_id
              DataSetIdentifier: waf_logs_antiddos_least_fields_v2
            Configuration:
              CustomFilterConfiguration:
                MatchOperator: EQUALS
                NullOption: NON_NULLS_ONLY
                ParameterName: AccountID
            FilterId: e59cfd9e-90a8-4d02-8d40-af54fd87de50
        ScopeConfiguration:
          SelectedSheets:
            SheetVisualScopingConfigurations:
            - Scope: ALL_VISUALS
              SheetId: f55c69b0-fdc6-4525-a2ae-ad14e397f41b
        Status: ENABLED
      - CrossDataset: SINGLE_DATASET
        FilterGroupId: c606352a-cad8-4910-bae1-d4175771b62b
        Filters:
        - CategoryFilter:
            Column:
              ColumnName: httpsourcename
              DataSetIdentifier: waf_logs_antiddos_least_fields_v2
            Configuration:
              FilterListConfiguration:
                MatchOperator: CONTAINS
                SelectAllOptions: FILTER_ALL_VALUES
            FilterId: eafb96ab-b609-4e0e-ad61-9a1c659d5be1
        ScopeConfiguration:
          SelectedSheets:
            SheetVisualScopingConfigurations:
            - Scope: ALL_VISUALS
              SheetId: f55c69b0-fdc6-4525-a2ae-ad14e397f41b
        Status: ENABLED
      - CrossDataset: SINGLE_DATASET
        FilterGroupId: ebc400fc-a73b-4196-992a-768012af3275
        Filters:
        - CategoryFilter:
            Column:
              ColumnName: httpsourcename
              DataSetIdentifier: waf_logs_antiddos_least_fields_v2
            Configuration:
              FilterListConfiguration:
                MatchOperator: CONTAINS
                SelectAllOptions: FILTER_ALL_VALUES
            FilterId: 5330570c-95dc-4c2e-a9c5-013140c6a358
        ScopeConfiguration:
          SelectedSheets:
            SheetVisualScopingConfigurations:
            - Scope: ALL_VISUALS
              SheetId: e5f34929-f856-45df-a4bd-25ffb3a7fb66
        Status: ENABLED
      - CrossDataset: SINGLE_DATASET
        FilterGroupId: 1e92736b-6f15-4492-8ec9-8915be28a0c9
        Filters:
        - CategoryFilter:
            Column:
              ColumnName: httpsourcename
              DataSetIdentifier: waf_logs_antiddos_least_fields_v2
            Configuration:
              FilterListConfiguration:
                MatchOperator: CONTAINS
                SelectAllOptions: FILTER_ALL_VALUES
            FilterId: 20ee9ba4-dc37-41c1-938a-0f2045f52b26
        ScopeConfiguration:
          SelectedSheets:
            SheetVisualScopingConfigurations:
            - Scope: ALL_VISUALS
              SheetId: 43b25c81-6789-49bd-bf7a-332b34aeefc9
        Status: ENABLED
      - CrossDataset: SINGLE_DATASET
        FilterGroupId: e6c7fb41-b6bd-46a6-b4f8-3170c56b1184
        Filters:
        - CategoryFilter:
            Column:
              ColumnName: httpsourcename
              DataSetIdentifier: waf_logs_antiddos_least_fields_v2
            Configuration:
              FilterListConfiguration:
                MatchOperator: CONTAINS
                SelectAllOptions: FILTER_ALL_VALUES
            FilterId: af3150bb-29d4-44b5-88c1-a8f60b3e9d05
        ScopeConfiguration:
          SelectedSheets:
            SheetVisualScopingConfigurations:
            - Scope: ALL_VISUALS
              SheetId: 84653b0c-13fc-4cf6-bef0-bbb1f840c6b7
        Status: ENABLED
      ParameterDeclarations:
      - StringParameterDeclaration:
          DefaultValues:
            DynamicValue:
              DefaultValueColumn:
                ColumnName: account_id
                DataSetIdentifier: waf_logs_antiddos_least_fields_v2
              GroupNameColumn:
                ColumnName: account_id
                DataSetIdentifier: waf_logs_antiddos_least_fields_v2
              UserNameColumn:
                ColumnName: account_id
                DataSetIdentifier: waf_logs_antiddos_least_fields_v2
          Name: AccountID
          ParameterValueType: MULTI_VALUED
          ValueWhenUnset:
            ValueWhenUnsetOption: RECOMMENDED_VALUE
      - StringParameterDeclaration:
          DefaultValues: {}
          Name: ProtectedRessources
          ParameterValueType: MULTI_VALUED
          ValueWhenUnset:
            ValueWhenUnsetOption: RECOMMENDED_VALUE
      - DateTimeParameterDeclaration:
          DefaultValues:
            StaticValues:
            - 2023-11-27 04:00:00+04:00
          Name: BaseLineStart
          TimeGranularity: MINUTE
      - DateTimeParameterDeclaration:
          DefaultValues:
            StaticValues:
            - 2023-11-28 04:00:00+04:00
          Name: BaseLineEnd
          TimeGranularity: MINUTE
      - DateTimeParameterDeclaration:
          DefaultValues:
            StaticValues:
            - 2023-12-12 04:00:00+04:00
          Name: EventStart
          TimeGranularity: MINUTE
      - DateTimeParameterDeclaration:
          DefaultValues:
            StaticValues:
            - 2023-12-14 04:00:00+04:00
          Name: EventEnd
          TimeGranularity: MINUTE
      - DateTimeParameterDeclaration:
          DefaultValues:
            StaticValues:
            - 2023-11-19 04:00:00+04:00
          Name: DataToAnalyzeStart
          TimeGranularity: MINUTE
      - DateTimeParameterDeclaration:
          DefaultValues:
            StaticValues:
            - 2023-12-17 04:00:00+04:00
          Name: DataToAnalyzeEnd
          TimeGranularity: MINUTE
      Sheets:
      - ContentType: INTERACTIVE
        FilterControls:
        - Dropdown:
            DisplayOptions:
              SelectAllOptions:
                Visibility: VISIBLE
            FilterControlId: d27bbc26-3627-4aad-8b6f-baaf2396c959
            SourceFilterId: eafb96ab-b609-4e0e-ad61-9a1c659d5be1
            Title: httpsourcename equals
            Type: MULTI_SELECT
        Layouts:
        - Configuration:
            GridLayout:
              Elements:
              - ColumnIndex: 0
                ColumnSpan: 14
                ElementId: 52aec769-0a68-41ed-8470-50a2f7d50c61
                ElementType: TEXT_BOX
                RowIndex: 0
                RowSpan: 3
              - ColumnIndex: 14
                ColumnSpan: 18
                ElementId: 928fc55a-b922-49d3-8cc0-6d605f52bda3
                ElementType: VISUAL
                RowIndex: 0
                RowSpan: 3
              - ColumnIndex: 0
                ColumnSpan: 14
                ElementId: 7599e3ca-56c4-4a4d-b638-c0232178b241
                ElementType: VISUAL
                RowIndex: 3
                RowSpan: 9
              - ColumnIndex: 14
                ColumnSpan: 13
                ElementId: c812ce89-0479-4f0d-8889-01448c0e83ab
                ElementType: VISUAL
                RowIndex: 3
                RowSpan: 6
              - ColumnIndex: 27
                ColumnSpan: 5
                ElementId: 19d64a26-597d-44ea-a72d-a64332c60820
                ElementType: TEXT_BOX
                RowIndex: 3
                RowSpan: 6
        Name: WAF-Logs-Dashboard-for-Event-Analysis
        ParameterControls:
        - DateTimePicker:
            DisplayOptions:
              DateTimeFormat: YYYY/MM/DD HH:mm:ss
              TitleOptions:
                FontConfiguration:
                  FontSize:
                    Relative: MEDIUM
                Visibility: VISIBLE
            ParameterControlId: 00ffe466-e9f0-41f6-a392-e9afc174a4ad
            SourceParameterName: BaseLineStart
            Title: BaseLine Start
        - DateTimePicker:
            DisplayOptions:
              DateTimeFormat: YYYY/MM/DD HH:mm:ss
              TitleOptions:
                FontConfiguration:
                  FontSize:
                    Relative: MEDIUM
                Visibility: VISIBLE
            ParameterControlId: f4613d56-7cc5-415e-8648-52f175b3fc5d
            SourceParameterName: BaseLineEnd
            Title: BaseLine End
        - DateTimePicker:
            DisplayOptions:
              DateTimeFormat: YYYY/MM/DD HH:mm:ss
              TitleOptions:
                FontConfiguration:
                  FontSize:
                    Relative: MEDIUM
                Visibility: VISIBLE
            ParameterControlId: 0a001f4a-ab1d-418e-8a41-6ab8a6bc0e1f
            SourceParameterName: EventStart
            Title: Event Start
        - DateTimePicker:
            DisplayOptions:
              DateTimeFormat: YYYY/MM/DD HH:mm:ss
              TitleOptions:
                FontConfiguration:
                  FontSize:
                    Relative: MEDIUM
                Visibility: VISIBLE
            ParameterControlId: 0b885115-9d96-478b-b2e2-d6b3dce11529
            SourceParameterName: EventEnd
            Title: Event End
        - DateTimePicker:
            DisplayOptions:
              DateTimeFormat: YYYY/MM/DD HH:mm:ss
              TitleOptions:
                FontConfiguration:
                  FontSize:
                    Relative: MEDIUM
                Visibility: VISIBLE
            ParameterControlId: ea6caa11-cf2a-462b-93df-d08c97bec2e9
            SourceParameterName: DataToAnalyzeStart
            Title: Start Date for Data Analysis
        - DateTimePicker:
            DisplayOptions:
              DateTimeFormat: YYYY/MM/DD HH:mm:ss
              TitleOptions:
                FontConfiguration:
                  FontSize:
                    Relative: MEDIUM
                Visibility: VISIBLE
            ParameterControlId: 5c83c6dd-c42c-43dc-a279-12206f1fa9d6
            SourceParameterName: DataToAnalyzeEnd
            Title: End Date for Data Analysis
        - Dropdown:
            DisplayOptions:
              SelectAllOptions:
                Visibility: VISIBLE
              TitleOptions:
                FontConfiguration:
                  FontSize:
                    Relative: MEDIUM
                Visibility: VISIBLE
            ParameterControlId: 500c9d82-e04d-431d-8dc9-dee0107ec0e7
            SelectableValues:
              LinkToDataSetColumn:
                ColumnName: account_id
                DataSetIdentifier: waf_logs_antiddos_least_fields_v2
            SourceParameterName: AccountID
            Title: Account_ID
            Type: MULTI_SELECT
        SheetControlLayouts:
        - Configuration:
            GridLayout:
              Elements:
              - ColumnIndex: 0
                ColumnSpan: 2
                ElementId: ea6caa11-cf2a-462b-93df-d08c97bec2e9
                ElementType: PARAMETER_CONTROL
                RowIndex: 0
                RowSpan: 1
              - ColumnIndex: 2
                ColumnSpan: 2
                ElementId: 5c83c6dd-c42c-43dc-a279-12206f1fa9d6
                ElementType: PARAMETER_CONTROL
                RowIndex: 0
                RowSpan: 1
              - ColumnIndex: 4
                ColumnSpan: 2
                ElementId: 00ffe466-e9f0-41f6-a392-e9afc174a4ad
                ElementType: PARAMETER_CONTROL
                RowIndex: 0
                RowSpan: 1
              - ColumnIndex: 6
                ColumnSpan: 2
                ElementId: f4613d56-7cc5-415e-8648-52f175b3fc5d
                ElementType: PARAMETER_CONTROL
                RowIndex: 0
                RowSpan: 1
              - ColumnIndex: 8
                ColumnSpan: 2
                ElementId: 0a001f4a-ab1d-418e-8a41-6ab8a6bc0e1f
                ElementType: PARAMETER_CONTROL
                RowIndex: 0
                RowSpan: 1
              - ColumnIndex: 10
                ColumnSpan: 2
                ElementId: 0b885115-9d96-478b-b2e2-d6b3dce11529
                ElementType: PARAMETER_CONTROL
                RowIndex: 0
                RowSpan: 1
              - ColumnIndex: 0
                ColumnSpan: 2
                ElementId: 500c9d82-e04d-431d-8dc9-dee0107ec0e7
                ElementType: PARAMETER_CONTROL
                RowIndex: 1
                RowSpan: 1
              - ColumnSpan: 2
                ElementId: d27bbc26-3627-4aad-8b6f-baaf2396c959
                ElementType: FILTER_CONTROL
                RowSpan: 1
        SheetId: f55c69b0-fdc6-4525-a2ae-ad14e397f41b
        TextBoxes:
        - Content: "<text-box>\n  The Graph below shows the\n  <inline color=\"#00ff00\"\
            >\n    <b>Total Request over Time</b>\n  </inline>\n  . This will help identify\
            \ the traffic Baseline and unsual traffic pattern that might represent an event.\
            \ You can set the start and End date for which you want data to be analyzed\
            \ using\n  <b>\_\"Start Date for Data Analysis\"\_</b>\n  and\n  <b>\_\"End\
            \ Date for Data Analysis\"</b>\n  \_field above.\n</text-box>"
          SheetTextBoxId: 52aec769-0a68-41ed-8470-50a2f7d50c61
        - Content: "<text-box>\n  The Graph below shows the\n  <inline color=\"#00ff00\"\
            >\n    <b>Total Request over Time grouped by Protected Resource ID</b>\n  </inline>\n\
            \  <inline color=\"#000000\">\n    <b>\_</b>\n  </inline>\n  which idendicates\
            \ the target resource of the traffic (eg. CloudFront resource ID, ALB resource\
            \ ID..).\n</text-box>"
          SheetTextBoxId: 19d64a26-597d-44ea-a72d-a64332c60820
        Visuals:
        - LineChartVisual:
            Actions: []
            ChartConfiguration:
              DataLabels:
                Overlap: DISABLE_OVERLAP
                Visibility: HIDDEN
              FieldWells:
                LineChartAggregatedFieldWells:
                  Category:
                  - DateDimensionField:
                      Column:
                        ColumnName: date_range
                        DataSetIdentifier: waf_logs_antiddos_least_fields_v2
                      DateGranularity: MINUTE
                      FieldId: ab0326db-3b45-4a3b-89f8-aa6d6007b786.1.1703000237284
                      HierarchyId: ab0326db-3b45-4a3b-89f8-aa6d6007b786.1.1703000237284
                  Colors: []
                  Values:
                  - CategoricalMeasureField:
                      AggregationFunction: COUNT
                      Column:
                        ColumnName: request_id
                        DataSetIdentifier: waf_logs_antiddos_least_fields_v2
                      FieldId: a286b2f7-8acf-4e80-8034-93bedf5e8aa7.request_id.1.1702542940685
              SortConfiguration:
                CategoryItemsLimitConfiguration:
                  OtherCategories: INCLUDE
                CategorySort:
                - FieldSort:
                    Direction: DESC
                    FieldId: ab0326db-3b45-4a3b-89f8-aa6d6007b786.1.1703000237284
                ColorItemsLimitConfiguration:
                  OtherCategories: INCLUDE
                SmallMultiplesLimitConfiguration:
                  OtherCategories: INCLUDE
              Tooltip:
                FieldBasedTooltip:
                  AggregationVisibility: HIDDEN
                  TooltipFields:
                  - FieldTooltipItem:
                      FieldId: a286b2f7-8acf-4e80-8034-93bedf5e8aa7.request_id.1.1702542940685
                      Visibility: VISIBLE
                  - FieldTooltipItem:
                      FieldId: ab0326db-3b45-4a3b-89f8-aa6d6007b786.1.1703000237284
                      Visibility: VISIBLE
                  TooltipTitleType: PRIMARY_VALUE
                SelectedTooltipType: DETAILED
                TooltipVisibility: VISIBLE
              Type: LINE
            ColumnHierarchies:
            - DateTimeHierarchy:
                HierarchyId: ab0326db-3b45-4a3b-89f8-aa6d6007b786.1.1703000237284
            Subtitle:
              Visibility: VISIBLE
            Title:
              FormatText:
                RichText: <visual-title>Total Request over Time</visual-title>
              Visibility: VISIBLE
            VisualId: 7599e3ca-56c4-4a4d-b638-c0232178b241
        - LineChartVisual:
            Actions: []
            ChartConfiguration:
              DataLabels:
                Overlap: DISABLE_OVERLAP
                Visibility: HIDDEN
              FieldWells:
                LineChartAggregatedFieldWells:
                  Category:
                  - DateDimensionField:
                      Column:
                        ColumnName: date_range
                        DataSetIdentifier: waf_logs_antiddos_least_fields_v2
                      DateGranularity: MINUTE
                      FieldId: ab0326db-3b45-4a3b-89f8-aa6d6007b786.2.1703000253916
                      HierarchyId: ab0326db-3b45-4a3b-89f8-aa6d6007b786.2.1703000253916
                  Colors:
                  - CategoricalDimensionField:
                      Column:
                        ColumnName: httpsourceid
                        DataSetIdentifier: waf_logs_antiddos_least_fields_v2
                      FieldId: a286b2f7-8acf-4e80-8034-93bedf5e8aa7.httpsourceid.2.1703090401467
                  Values:
                  - CategoricalMeasureField:
                      AggregationFunction: COUNT
                      Column:
                        ColumnName: httpsourceid
                        DataSetIdentifier: waf_logs_antiddos_least_fields_v2
                      FieldId: a286b2f7-8acf-4e80-8034-93bedf5e8aa7.httpsourceid.2.1703090403149
              Legend:
                Visibility: VISIBLE
              SortConfiguration:
                CategoryItemsLimitConfiguration:
                  OtherCategories: INCLUDE
                CategorySort:
                - FieldSort:
                    Direction: DESC
                    FieldId: ab0326db-3b45-4a3b-89f8-aa6d6007b786.2.1703000253916
                ColorItemsLimitConfiguration:
                  OtherCategories: INCLUDE
                SmallMultiplesLimitConfiguration:
                  OtherCategories: INCLUDE
              Tooltip:
                FieldBasedTooltip:
                  AggregationVisibility: HIDDEN
                  TooltipFields:
                  - FieldTooltipItem:
                      FieldId: ab0326db-3b45-4a3b-89f8-aa6d6007b786.2.1703000253916
                      Visibility: VISIBLE
                  - FieldTooltipItem:
                      FieldId: a286b2f7-8acf-4e80-8034-93bedf5e8aa7.httpsourceid.2.1703090401467
                      Visibility: VISIBLE
                  - FieldTooltipItem:
                      FieldId: a286b2f7-8acf-4e80-8034-93bedf5e8aa7.httpsourceid.2.1703090401467
                      Visibility: VISIBLE
                  TooltipTitleType: PRIMARY_VALUE
                SelectedTooltipType: DETAILED
                TooltipVisibility: VISIBLE
              Type: LINE
            ColumnHierarchies:
            - DateTimeHierarchy:
                HierarchyId: ab0326db-3b45-4a3b-89f8-aa6d6007b786.2.1703000253916
            Subtitle:
              Visibility: VISIBLE
            Title:
              FormatText:
                RichText: <visual-title>Total Requests per Protected_Resource_ID (e.g. CloudFront
                  ID)</visual-title>
              Visibility: VISIBLE
            VisualId: c812ce89-0479-4f0d-8889-01448c0e83ab
        - WordCloudVisual:
            Actions: []
            ChartConfiguration:
              FieldWells:
                WordCloudAggregatedFieldWells:
                  GroupBy:
                  - CategoricalDimensionField:
                      Column:
                        ColumnName: account_id
                        DataSetIdentifier: waf_logs_antiddos_least_fields_v2
                      FieldId: a286b2f7-8acf-4e80-8034-93bedf5e8aa7.account_id.0.1702547192181
                  Size:
                  - CategoricalMeasureField:
                      AggregationFunction: COUNT
                      Column:
                        ColumnName: account_id
                        DataSetIdentifier: waf_logs_antiddos_least_fields_v2
                      FieldId: a286b2f7-8acf-4e80-8034-93bedf5e8aa7.account_id.1.1702547204091
              SortConfiguration:
                CategoryItemsLimit:
                  OtherCategories: INCLUDE
              WordCloudOptions: {}
            ColumnHierarchies: []
            Subtitle:
              Visibility: VISIBLE
            Title:
              FormatText:
                RichText: <visual-title>Total generated records per Account ID trend</visual-title>
              Visibility: VISIBLE
            VisualId: 928fc55a-b922-49d3-8cc0-6d605f52bda3
      - ContentType: INTERACTIVE
        FilterControls:
        - Dropdown:
            DisplayOptions:
              SelectAllOptions:
                Visibility: VISIBLE
            FilterControlId: 55747674-547a-463a-aaeb-86a7a5df6933
            SourceFilterId: 5330570c-95dc-4c2e-a9c5-013140c6a358
            Title: httpsourcename equals
            Type: MULTI_SELECT
        Layouts:
        - Configuration:
            GridLayout:
              CanvasSizeOptions:
                ScreenCanvasSizeOptions:
                  OptimizedViewPortWidth: 1600px
                  ResizeOption: FIXED
              Elements:
              - ColumnIndex: 0
                ColumnSpan: 30
                ElementId: 95093edc-f15f-4cea-9d20-694c92aec8a9
                ElementType: TEXT_BOX
                RowIndex: 0
                RowSpan: 4
              - ColumnIndex: 0
                ColumnSpan: 13
                ElementId: 6fa80101-2c15-4d90-8052-629cf63a7528
                ElementType: VISUAL
                RowIndex: 4
                RowSpan: 8
              - ColumnIndex: 13
                ColumnSpan: 13
                ElementId: 9e5ee902-fcb3-468d-b7a7-67ea822e7b9e
                ElementType: VISUAL
                RowIndex: 4
                RowSpan: 8
              - ColumnIndex: 0
                ColumnSpan: 13
                ElementId: 988d27b1-b21d-4c4e-a8a5-8983e3502643
                ElementType: VISUAL
                RowIndex: 12
                RowSpan: 7
              - ColumnIndex: 13
                ColumnSpan: 13
                ElementId: db25c602-1c14-435d-9e64-1d3ac58bad41
                ElementType: VISUAL
                RowIndex: 12
                RowSpan: 7
              - ColumnIndex: 0
                ColumnSpan: 13
                ElementId: d80b8168-75b0-48d6-9500-a8ee51fd8dfc
                ElementType: VISUAL
                RowIndex: 19
                RowSpan: 12
              - ColumnSpan: 13
                ElementId: bc1a6524-92ea-4f11-b4e4-5f84f665ef4f
                ElementType: VISUAL
                RowSpan: 12
        Name: ClientIP_Country_HTTP_Methods
        ParameterControls:
        - DateTimePicker:
            DisplayOptions:
              DateTimeFormat: YYYY/MM/DD HH:mm:ss
              TitleOptions:
                FontConfiguration:
                  FontSize:
                    Relative: MEDIUM
                Visibility: VISIBLE
            ParameterControlId: 4a3493b6-349d-438e-bb08-e2a2f808bd44
            SourceParameterName: BaseLineStart
            Title: BaseLine Start
        - DateTimePicker:
            DisplayOptions:
              DateTimeFormat: YYYY/MM/DD HH:mm:ss
              TitleOptions:
                FontConfiguration:
                  FontSize:
                    Relative: MEDIUM
                Visibility: VISIBLE
            ParameterControlId: 7f3b8f2a-e696-4f2c-bb90-42dc69b2a8dc
            SourceParameterName: BaseLineEnd
            Title: BaseLine End
        - DateTimePicker:
            DisplayOptions:
              DateTimeFormat: YYYY/MM/DD HH:mm:ss
              TitleOptions:
                FontConfiguration:
                  FontSize:
                    Relative: MEDIUM
                Visibility: VISIBLE
            ParameterControlId: 0ebe0049-e272-4c43-b0cf-343fdccc90e9
            SourceParameterName: EventStart
            Title: Event Start
        - DateTimePicker:
            DisplayOptions:
              DateTimeFormat: YYYY/MM/DD HH:mm:ss
              TitleOptions:
                FontConfiguration:
                  FontSize:
                    Relative: MEDIUM
                Visibility: VISIBLE
            ParameterControlId: 2c217b59-dfb4-406e-9f1e-4ca1a6629448
            SourceParameterName: EventEnd
            Title: Event End
        - Dropdown:
            DisplayOptions:
              SelectAllOptions:
                Visibility: VISIBLE
              TitleOptions:
                FontConfiguration:
                  FontSize:
                    Relative: MEDIUM
                Visibility: VISIBLE
            ParameterControlId: c435aebf-5114-4871-a93a-6e816d696ea6
            SourceParameterName: AccountID
            Title: Account ID
            Type: MULTI_SELECT
        SheetControlLayouts:
        - Configuration:
            GridLayout:
              Elements:
              - ColumnSpan: 2
                ElementId: 4a3493b6-349d-438e-bb08-e2a2f808bd44
                ElementType: PARAMETER_CONTROL
                RowSpan: 1
              - ColumnSpan: 2
                ElementId: 7f3b8f2a-e696-4f2c-bb90-42dc69b2a8dc
                ElementType: PARAMETER_CONTROL
                RowSpan: 1
              - ColumnSpan: 2
                ElementId: 0ebe0049-e272-4c43-b0cf-343fdccc90e9
                ElementType: PARAMETER_CONTROL
                RowSpan: 1
              - ColumnSpan: 2
                ElementId: 2c217b59-dfb4-406e-9f1e-4ca1a6629448
                ElementType: PARAMETER_CONTROL
                RowSpan: 1
              - ColumnSpan: 2
                ElementId: c435aebf-5114-4871-a93a-6e816d696ea6
                ElementType: PARAMETER_CONTROL
                RowSpan: 1
              - ColumnSpan: 2
                ElementId: 55747674-547a-463a-aaeb-86a7a5df6933
                ElementType: FILTER_CONTROL
                RowSpan: 1
        SheetId: e5f34929-f856-45df-a4bd-25ffb3a7fb66
        TextBoxes:
        - Content: "<text-box>\n  The following sections representes the details of the\
            \ HTTP requests (Client IP, Region and HTTP Methods). this helps to identify\
            \ the caracteristics of the event. The graphs on the left represent Client IP\
            \ and Country from the Baseline requests. The Graphs on the right represent\
            \ ClientIP and Country from the Event requests. This allow comparing the traffic\
            \ pattern between your expected type of traffic and the malicious one.\n  <br/>\n\
            \  <br/>\n  Once you identify the mallicious request's Client IP and Country,\
            \ you can build\n  <a href=\"https://docs.aws.amazon.com/waf/latest/developerguide/waf-rule-statement-type-ipset-match.html\"\
            \ target=\"_blank\">IP set match rule statement\_</a>\n  or\n  <a href=\"https://docs.aws.amazon.com/waf/latest/developerguide/waf-rule-statement-type-geo-match.html\"\
            \ target=\"_blank\">geographic match rule statement\_</a>\n  \_to block them.\n\
            \  <br/>\n  <br/>\n  You can set the timestamp of both Basline and Event in\
            \ the controls files on the top of the current sheet (\n  <b>BaselineStart,\
            \ BaselineEnd, EventStart, EventEnd</b>\n  ). For more information about AWS\
            \ WAF logs field, please check this link\n  <a href=\"https://docs.aws.amazon.com/waf/latest/developerguide/logging-fields.html\"\
            \ target=\"_blank\">https://docs.aws.amazon.com/waf/latest/developerguide/logging-fields.html</a>\n\
            </text-box>"
          SheetTextBoxId: 95093edc-f15f-4cea-9d20-694c92aec8a9
        Visuals:
        - PieChartVisual:
            Actions: []
            ChartConfiguration:
              DataLabels:
                Overlap: DISABLE_OVERLAP
                Visibility: VISIBLE
              DonutOptions:
                ArcOptions:
                  ArcThickness: MEDIUM
              FieldWells:
                PieChartAggregatedFieldWells:
                  Category:
                  - CategoricalDimensionField:
                      Column:
                        ColumnName: httpmethod
                        DataSetIdentifier: waf_logs_antiddos_least_fields_v2
                      FieldId: a286b2f7-8acf-4e80-8034-93bedf5e8aa7.httpmethod.0.1703075953196
                  Values: []
              SortConfiguration:
                CategoryItemsLimit:
                  OtherCategories: INCLUDE
                SmallMultiplesLimitConfiguration:
                  OtherCategories: INCLUDE
              Tooltip:
                FieldBasedTooltip:
                  AggregationVisibility: HIDDEN
                  TooltipFields:
                  - FieldTooltipItem:
                      FieldId: a286b2f7-8acf-4e80-8034-93bedf5e8aa7.httpmethod.0.1703075953196
                      Visibility: VISIBLE
                  TooltipTitleType: PRIMARY_VALUE
                SelectedTooltipType: DETAILED
                TooltipVisibility: VISIBLE
            ColumnHierarchies: []
            Subtitle:
              Visibility: VISIBLE
            Title:
              FormatText:
                RichText: '<visual-title>Event: HTTP Method</visual-title>'
              Visibility: VISIBLE
            VisualId: bc1a6524-92ea-4f11-b4e4-5f84f665ef4f
        - PieChartVisual:
            Actions: []
            ChartConfiguration:
              DataLabels:
                Overlap: DISABLE_OVERLAP
                Visibility: VISIBLE
              DonutOptions:
                ArcOptions:
                  ArcThickness: MEDIUM
              FieldWells:
                PieChartAggregatedFieldWells:
                  Category:
                  - CategoricalDimensionField:
                      Column:
                        ColumnName: country
                        DataSetIdentifier: waf_logs_antiddos_least_fields_v2
                      FieldId: a286b2f7-8acf-4e80-8034-93bedf5e8aa7.country.0.1702543652206
                  Values: []
              SortConfiguration:
                CategoryItemsLimit:
                  OtherCategories: INCLUDE
                SmallMultiplesLimitConfiguration:
                  OtherCategories: INCLUDE
              Tooltip:
                FieldBasedTooltip:
                  AggregationVisibility: HIDDEN
                  TooltipFields:
                  - FieldTooltipItem:
                      FieldId: a286b2f7-8acf-4e80-8034-93bedf5e8aa7.country.0.1702543652206
                      Visibility: VISIBLE
                  TooltipTitleType: PRIMARY_VALUE
                SelectedTooltipType: DETAILED
                TooltipVisibility: VISIBLE
            ColumnHierarchies: []
            Subtitle:
              Visibility: VISIBLE
            Title:
              FormatText:
                RichText: |-
                  <visual-title>
                    <b>Event</b>
                    :  Records by Country
                  </visual-title>
              Visibility: VISIBLE
            VisualId: db25c602-1c14-435d-9e64-1d3ac58bad41
        - PieChartVisual:
            Actions: []
            ChartConfiguration:
              DataLabels:
                Overlap: DISABLE_OVERLAP
                Visibility: VISIBLE
              DonutOptions:
                ArcOptions:
                  ArcThickness: MEDIUM
              FieldWells:
                PieChartAggregatedFieldWells:
                  Category:
                  - CategoricalDimensionField:
                      Column:
                        ColumnName: country
                        DataSetIdentifier: waf_logs_antiddos_least_fields_v2
                      FieldId: a286b2f7-8acf-4e80-8034-93bedf5e8aa7.country.0.1702543652206
                  Values: []
              SortConfiguration:
                CategoryItemsLimit:
                  OtherCategories: INCLUDE
                SmallMultiplesLimitConfiguration:
                  OtherCategories: INCLUDE
              Tooltip:
                FieldBasedTooltip:
                  AggregationVisibility: HIDDEN
                  TooltipFields:
                  - FieldTooltipItem:
                      FieldId: a286b2f7-8acf-4e80-8034-93bedf5e8aa7.country.0.1702543652206
                      Visibility: VISIBLE
                  TooltipTitleType: PRIMARY_VALUE
                SelectedTooltipType: DETAILED
                TooltipVisibility: VISIBLE
            ColumnHierarchies: []
            Subtitle:
              Visibility: VISIBLE
            Title:
              FormatText:
                RichText: |-
                  <visual-title>
                    <b>Baseline</b>
                    :  Records by Country
                  </visual-title>
              Visibility: VISIBLE
            VisualId: 988d27b1-b21d-4c4e-a8a5-8983e3502643
        - PieChartVisual:
            Actions: []
            ChartConfiguration:
              DataLabels:
                Overlap: DISABLE_OVERLAP
                Visibility: VISIBLE
              DonutOptions:
                ArcOptions:
                  ArcThickness: MEDIUM
              FieldWells:
                PieChartAggregatedFieldWells:
                  Category:
                  - CategoricalDimensionField:
                      Column:
                        ColumnName: clientip
                        DataSetIdentifier: waf_logs_antiddos_least_fields_v2
                      FieldId: a286b2f7-8acf-4e80-8034-93bedf5e8aa7.clientip.0.1702543621454
                  Values: []
              SortConfiguration:
                CategoryItemsLimit:
                  OtherCategories: INCLUDE
                SmallMultiplesLimitConfiguration:
                  OtherCategories: INCLUDE
              Tooltip:
                FieldBasedTooltip:
                  AggregationVisibility: HIDDEN
                  TooltipFields:
                  - FieldTooltipItem:
                      FieldId: a286b2f7-8acf-4e80-8034-93bedf5e8aa7.clientip.0.1702543621454
                      Visibility: VISIBLE
                  TooltipTitleType: PRIMARY_VALUE
                SelectedTooltipType: DETAILED
                TooltipVisibility: VISIBLE
            ColumnHierarchies: []
            Subtitle:
              Visibility: VISIBLE
            Title:
              FormatText:
                RichText: '<visual-title>Event:  Records by Client IP</visual-title>'
              Visibility: VISIBLE
            VisualId: 9e5ee902-fcb3-468d-b7a7-67ea822e7b9e
        - PieChartVisual:
            Actions: []
            ChartConfiguration:
              DataLabels:
                Overlap: DISABLE_OVERLAP
                Visibility: VISIBLE
              DonutOptions:
                ArcOptions:
                  ArcThickness: MEDIUM
              FieldWells:
                PieChartAggregatedFieldWells:
                  Category:
                  - CategoricalDimensionField:
                      Column:
                        ColumnName: clientip
                        DataSetIdentifier: waf_logs_antiddos_least_fields_v2
                      FieldId: a286b2f7-8acf-4e80-8034-93bedf5e8aa7.clientip.0.1702543621454
                  Values: []
              SortConfiguration:
                CategoryItemsLimit:
                  OtherCategories: INCLUDE
                SmallMultiplesLimitConfiguration:
                  OtherCategories: INCLUDE
              Tooltip:
                FieldBasedTooltip:
                  AggregationVisibility: HIDDEN
                  TooltipFields:
                  - FieldTooltipItem:
                      FieldId: a286b2f7-8acf-4e80-8034-93bedf5e8aa7.clientip.0.1702543621454
                      Visibility: VISIBLE
                  TooltipTitleType: PRIMARY_VALUE
                SelectedTooltipType: DETAILED
                TooltipVisibility: VISIBLE
            ColumnHierarchies: []
            Subtitle:
              Visibility: VISIBLE
            Title:
              FormatText:
                RichText: '<visual-title>Baseline:  Records by Client IP</visual-title>'
              Visibility: VISIBLE
            VisualId: 6fa80101-2c15-4d90-8052-629cf63a7528
        - PieChartVisual:
            Actions: []
            ChartConfiguration:
              DataLabels:
                Overlap: DISABLE_OVERLAP
                Visibility: VISIBLE
              DonutOptions:
                ArcOptions:
                  ArcThickness: MEDIUM
              FieldWells:
                PieChartAggregatedFieldWells:
                  Category:
                  - CategoricalDimensionField:
                      Column:
                        ColumnName: httpmethod
                        DataSetIdentifier: waf_logs_antiddos_least_fields_v2
                      FieldId: a286b2f7-8acf-4e80-8034-93bedf5e8aa7.httpmethod.0.1703075953196
                  Values: []
              SortConfiguration:
                CategoryItemsLimit:
                  OtherCategories: INCLUDE
                SmallMultiplesLimitConfiguration:
                  OtherCategories: INCLUDE
              Tooltip:
                FieldBasedTooltip:
                  AggregationVisibility: HIDDEN
                  TooltipFields:
                  - FieldTooltipItem:
                      FieldId: a286b2f7-8acf-4e80-8034-93bedf5e8aa7.httpmethod.0.1703075953196
                      Visibility: VISIBLE
                  TooltipTitleType: PRIMARY_VALUE
                SelectedTooltipType: DETAILED
                TooltipVisibility: VISIBLE
            ColumnHierarchies: []
            Subtitle:
              Visibility: VISIBLE
            Title:
              FormatText:
                RichText: '<visual-title>BaseLine: HTTP Method</visual-title>'
              Visibility: VISIBLE
            VisualId: d80b8168-75b0-48d6-9500-a8ee51fd8dfc
      - ContentType: INTERACTIVE
        FilterControls:
        - Dropdown:
            DisplayOptions:
              SelectAllOptions:
                Visibility: VISIBLE
            FilterControlId: b0518d84-c15b-461b-b3c9-4c75140f522d
            SourceFilterId: 20ee9ba4-dc37-41c1-938a-0f2045f52b26
            Title: httpsourcename equals
            Type: MULTI_SELECT
        Layouts:
        - Configuration:
            GridLayout:
              CanvasSizeOptions:
                ScreenCanvasSizeOptions:
                  OptimizedViewPortWidth: 1600px
                  ResizeOption: FIXED
              Elements:
              - ColumnIndex: 0
                ColumnSpan: 31
                ElementId: 5f4b5899-bc03-47e3-836b-2f11b0c74b87
                ElementType: TEXT_BOX
                RowIndex: 0
                RowSpan: 4
              - ColumnIndex: 0
                ColumnSpan: 13
                ElementId: 19faa481-7324-4dd7-a40e-f6108c662bf2
                ElementType: VISUAL
                RowIndex: 4
                RowSpan: 7
              - ColumnIndex: 13
                ColumnSpan: 13
                ElementId: 707522af-7cc8-4831-bf16-cadc910bfd93
                ElementType: VISUAL
                RowIndex: 4
                RowSpan: 7
              - ColumnIndex: 0
                ColumnSpan: 13
                ElementId: f610f253-ecdd-4a90-ae9f-1b7ba4a88750
                ElementType: VISUAL
                RowIndex: 11
                RowSpan: 7
              - ColumnIndex: 13
                ColumnSpan: 13
                ElementId: a41ddd59-da43-48ce-8392-9e7f3785291f
                ElementType: VISUAL
                RowIndex: 11
                RowSpan: 7
              - ColumnIndex: 0
                ColumnSpan: 13
                ElementId: added081-1a71-4574-8bd8-3207bb491d70
                ElementType: VISUAL
                RowIndex: 18
                RowSpan: 10
              - ColumnIndex: 13
                ColumnSpan: 13
                ElementId: a8566472-9767-4526-b795-cf7417f6ed5c
                ElementType: VISUAL
                RowIndex: 18
                RowSpan: 10
        Name: Header_Value_based_Insights
        ParameterControls:
        - DateTimePicker:
            DisplayOptions:
              DateTimeFormat: YYYY/MM/DD HH:mm:ss
              TitleOptions:
                FontConfiguration:
                  FontSize:
                    Relative: MEDIUM
                Visibility: VISIBLE
            ParameterControlId: d1f2eb28-6fc8-4cae-affa-f04f6f87966a
            SourceParameterName: BaseLineStart
            Title: BaseLine Start
        - DateTimePicker:
            DisplayOptions:
              DateTimeFormat: YYYY/MM/DD HH:mm:ss
              TitleOptions:
                FontConfiguration:
                  FontSize:
                    Relative: MEDIUM
                Visibility: VISIBLE
            ParameterControlId: d64cdfcf-27cf-4728-9907-3e5cf1507f4e
            SourceParameterName: BaseLineEnd
            Title: BaseLine End
        - DateTimePicker:
            DisplayOptions:
              DateTimeFormat: YYYY/MM/DD HH:mm:ss
              TitleOptions:
                FontConfiguration:
                  FontSize:
                    Relative: MEDIUM
                Visibility: VISIBLE
            ParameterControlId: fec1232f-47d7-46f8-a789-2b10f9eef152
            SourceParameterName: EventStart
            Title: Event Start
        - DateTimePicker:
            DisplayOptions:
              DateTimeFormat: YYYY/MM/DD HH:mm:ss
              TitleOptions:
                FontConfiguration:
                  FontSize:
                    Relative: MEDIUM
                Visibility: VISIBLE
            ParameterControlId: 28fa3c4b-1cfa-42fb-a2d1-d0abe046124f
            SourceParameterName: EventEnd
            Title: Event End
        - Dropdown:
            DisplayOptions:
              SelectAllOptions:
                Visibility: VISIBLE
              TitleOptions:
                FontConfiguration:
                  FontSize:
                    Relative: MEDIUM
                Visibility: VISIBLE
            ParameterControlId: 84252511-2483-4e30-b8ce-91bcfc6ac7df
            SourceParameterName: AccountID
            Title: Account ID
            Type: MULTI_SELECT
        SheetControlLayouts:
        - Configuration:
            GridLayout:
              Elements:
              - ColumnSpan: 2
                ElementId: d1f2eb28-6fc8-4cae-affa-f04f6f87966a
                ElementType: PARAMETER_CONTROL
                RowSpan: 1
              - ColumnSpan: 2
                ElementId: d64cdfcf-27cf-4728-9907-3e5cf1507f4e
                ElementType: PARAMETER_CONTROL
                RowSpan: 1
              - ColumnSpan: 2
                ElementId: fec1232f-47d7-46f8-a789-2b10f9eef152
                ElementType: PARAMETER_CONTROL
                RowSpan: 1
              - ColumnSpan: 2
                ElementId: 28fa3c4b-1cfa-42fb-a2d1-d0abe046124f
                ElementType: PARAMETER_CONTROL
                RowSpan: 1
              - ColumnSpan: 2
                ElementId: 84252511-2483-4e30-b8ce-91bcfc6ac7df
                ElementType: PARAMETER_CONTROL
                RowSpan: 1
              - ColumnSpan: 2
                ElementId: b0518d84-c15b-461b-b3c9-4c75140f522d
                ElementType: FILTER_CONTROL
                RowSpan: 1
        SheetId: 43b25c81-6789-49bd-bf7a-332b34aeefc9
        TextBoxes:
        - Content: "<text-box>\n  The following sections representes the details of the\
            \ URI,  Header Name and Header Value. this helps to identify the caracteristics\
            \ of the event . The graphs on the left represent insights from the Baseline\
            \ requests. The Graphs on the right represent insights from the Event requests.\
            \ This allow comparing the traffic pattern between your expected type of traffic\
            \ and the malicious one.\n  <br/>\n  <br/>\n  Once you identify the mallicious\
            \ request's Header details for ewample, you can build\n  <a href=\"https://docs.aws.amazon.com/waf/latest/developerguide/waf-rule-statement-type-string-match.html\"\
            \ target=\"_blank\">string match rule\_</a>\n  <a href=\"https://docs.aws.amazon.com/waf/latest/developerguide/waf-rule-statement-type-geo-match.html\"\
            \ target=\"_blank\">\_</a>\n  \_to block them.\n  <br/>\n  <br/>\n  You can\
            \ set the timestamp of both Basline and Event in the controls files on the top\
            \ of the current sheet (\n  <b>BaselineStart, BaselineEnd, EventStart, EventEnd</b>\n\
            \  ). For more information about AWS WAF logs field, please check this link\n\
            \  <a href=\"https://docs.aws.amazon.com/waf/latest/developerguide/logging-fields.html\"\
            \ target=\"_blank\">https://docs.aws.amazon.com/waf/latest/developerguide/logging-fields.html</a>\n\
            </text-box>"
          SheetTextBoxId: 5f4b5899-bc03-47e3-836b-2f11b0c74b87
        Visuals:
        - PivotTableVisual:
            Actions: []
            ChartConfiguration:
              FieldOptions:
                SelectedFieldOptions:
                - FieldId: a286b2f7-8acf-4e80-8034-93bedf5e8aa7.header_name.0.1702543925404
                  Visibility: VISIBLE
                - FieldId: a286b2f7-8acf-4e80-8034-93bedf5e8aa7.hearder_value.1.1702543929750
                  Visibility: VISIBLE
                - FieldId: a286b2f7-8acf-4e80-8034-93bedf5e8aa7.clientip.2.1702543931959
                  Visibility: VISIBLE
              FieldWells:
                PivotTableAggregatedFieldWells:
                  Columns:
                  - CategoricalDimensionField:
                      Column:
                        ColumnName: clientip
                        DataSetIdentifier: waf_logs_antiddos_least_fields_v2
                      FieldId: a286b2f7-8acf-4e80-8034-93bedf5e8aa7.clientip.2.1702543931959
                  Rows:
                  - CategoricalDimensionField:
                      Column:
                        ColumnName: header_name
                        DataSetIdentifier: waf_logs_antiddos_least_fields_v2
                      FieldId: a286b2f7-8acf-4e80-8034-93bedf5e8aa7.header_name.0.1702543925404
                  - CategoricalDimensionField:
                      Column:
                        ColumnName: hearder_value
                        DataSetIdentifier: waf_logs_antiddos_least_fields_v2
                      FieldId: a286b2f7-8acf-4e80-8034-93bedf5e8aa7.hearder_value.1.1702543929750
                  Values: []
              SortConfiguration:
                FieldSortOptions: []
              TableOptions:
                CellStyle: {}
                CollapsedRowDimensionsVisibility: HIDDEN
                ColumnHeaderStyle: {}
                RowAlternateColorOptions:
                  Status: DISABLED
              TotalOptions:
                ColumnTotalOptions:
                  Placement: END
                RowSubtotalOptions:
                  CustomLabel: <<$aws:subtotalDimension>> Subtotal
                  MetricHeaderCellStyle: {}
                  TotalCellStyle: {}
                  TotalsVisibility: VISIBLE
                  ValueCellStyle: {}
                RowTotalOptions:
                  Placement: AUTO
            Subtitle:
              Visibility: VISIBLE
            Title:
              FormatText:
                RichText: "<visual-title>\n  <b>Event :</b>\n  \_Records combined by Header\
                  \ Name, Header Value and Client IP\n</visual-title>"
              Visibility: VISIBLE
            VisualId: a8566472-9767-4526-b795-cf7417f6ed5c
        - PivotTableVisual:
            Actions: []
            ChartConfiguration:
              FieldOptions:
                SelectedFieldOptions:
                - FieldId: a286b2f7-8acf-4e80-8034-93bedf5e8aa7.header_name.0.1702543925404
                  Visibility: VISIBLE
                - FieldId: a286b2f7-8acf-4e80-8034-93bedf5e8aa7.hearder_value.1.1702543929750
                  Visibility: VISIBLE
                - FieldId: a286b2f7-8acf-4e80-8034-93bedf5e8aa7.clientip.2.1702543931959
                  Visibility: VISIBLE
              FieldWells:
                PivotTableAggregatedFieldWells:
                  Columns:
                  - CategoricalDimensionField:
                      Column:
                        ColumnName: clientip
                        DataSetIdentifier: waf_logs_antiddos_least_fields_v2
                      FieldId: a286b2f7-8acf-4e80-8034-93bedf5e8aa7.clientip.2.1702543931959
                  Rows:
                  - CategoricalDimensionField:
                      Column:
                        ColumnName: header_name
                        DataSetIdentifier: waf_logs_antiddos_least_fields_v2
                      FieldId: a286b2f7-8acf-4e80-8034-93bedf5e8aa7.header_name.0.1702543925404
                  - CategoricalDimensionField:
                      Column:
                        ColumnName: hearder_value
                        DataSetIdentifier: waf_logs_antiddos_least_fields_v2
                      FieldId: a286b2f7-8acf-4e80-8034-93bedf5e8aa7.hearder_value.1.1702543929750
                  Values: []
              SortConfiguration:
                FieldSortOptions: []
              TableOptions:
                CellStyle: {}
                CollapsedRowDimensionsVisibility: HIDDEN
                ColumnHeaderStyle: {}
                RowAlternateColorOptions:
                  Status: DISABLED
              TotalOptions:
                ColumnTotalOptions:
                  Placement: END
                RowSubtotalOptions:
                  CustomLabel: <<$aws:subtotalDimension>> Subtotal
                  MetricHeaderCellStyle: {}
                  TotalCellStyle: {}
                  TotalsVisibility: VISIBLE
                  ValueCellStyle: {}
                RowTotalOptions:
                  Placement: AUTO
            Subtitle:
              Visibility: VISIBLE
            Title:
              FormatText:
                RichText: "<visual-title>\n  <b>BaseLine :</b>\n  \_Records combined by\
                  \ Header Name, Header Value and Client IP\n</visual-title>"
              Visibility: VISIBLE
            VisualId: added081-1a71-4574-8bd8-3207bb491d70
        - PivotTableVisual:
            Actions: []
            ChartConfiguration:
              FieldOptions:
                DataPathOptions: []
                SelectedFieldOptions:
                - FieldId: a286b2f7-8acf-4e80-8034-93bedf5e8aa7.uri.0.1702543696709
                  Visibility: VISIBLE
                - FieldId: a286b2f7-8acf-4e80-8034-93bedf5e8aa7.clientip.1.1702543709262
                  Visibility: VISIBLE
                - FieldId: a286b2f7-8acf-4e80-8034-93bedf5e8aa7.country.2.1702543733385
                  Visibility: VISIBLE
              FieldWells:
                PivotTableAggregatedFieldWells:
                  Columns:
                  - CategoricalDimensionField:
                      Column:
                        ColumnName: country
                        DataSetIdentifier: waf_logs_antiddos_least_fields_v2
                      FieldId: a286b2f7-8acf-4e80-8034-93bedf5e8aa7.country.2.1702543733385
                  Rows:
                  - CategoricalDimensionField:
                      Column:
                        ColumnName: uri
                        DataSetIdentifier: waf_logs_antiddos_least_fields_v2
                      FieldId: a286b2f7-8acf-4e80-8034-93bedf5e8aa7.uri.0.1702543696709
                  - CategoricalDimensionField:
                      Column:
                        ColumnName: clientip
                        DataSetIdentifier: waf_logs_antiddos_least_fields_v2
                      FieldId: a286b2f7-8acf-4e80-8034-93bedf5e8aa7.clientip.1.1702543709262
                  Values: []
              SortConfiguration:
                FieldSortOptions: []
              TableOptions:
                CellStyle: {}
                CollapsedRowDimensionsVisibility: HIDDEN
                ColumnHeaderStyle: {}
                RowAlternateColorOptions:
                  Status: DISABLED
              TotalOptions:
                ColumnTotalOptions:
                  Placement: END
                RowSubtotalOptions:
                  CustomLabel: <<$aws:subtotalDimension>> Subtotal
                  MetricHeaderCellStyle: {}
                  TotalCellStyle: {}
                  TotalsVisibility: VISIBLE
                  ValueCellStyle: {}
                RowTotalOptions:
                  Placement: AUTO
            Subtitle:
              Visibility: VISIBLE
            Title:
              FormatText:
                RichText: "<visual-title>\n  <b>Event :</b>\n  \_Records combined by URI,\
                  \ Country and Client IP\n</visual-title>"
              Visibility: VISIBLE
            VisualId: a41ddd59-da43-48ce-8392-9e7f3785291f
        - PivotTableVisual:
            Actions: []
            ChartConfiguration:
              FieldOptions:
                SelectedFieldOptions:
                - FieldId: a286b2f7-8acf-4e80-8034-93bedf5e8aa7.uri.0.1702543696709
                  Visibility: VISIBLE
                - FieldId: a286b2f7-8acf-4e80-8034-93bedf5e8aa7.clientip.1.1702543709262
                  Visibility: VISIBLE
                - FieldId: a286b2f7-8acf-4e80-8034-93bedf5e8aa7.country.2.1702543733385
                  Visibility: VISIBLE
              FieldWells:
                PivotTableAggregatedFieldWells:
                  Columns:
                  - CategoricalDimensionField:
                      Column:
                        ColumnName: country
                        DataSetIdentifier: waf_logs_antiddos_least_fields_v2
                      FieldId: a286b2f7-8acf-4e80-8034-93bedf5e8aa7.country.2.1702543733385
                  Rows:
                  - CategoricalDimensionField:
                      Column:
                        ColumnName: uri
                        DataSetIdentifier: waf_logs_antiddos_least_fields_v2
                      FieldId: a286b2f7-8acf-4e80-8034-93bedf5e8aa7.uri.0.1702543696709
                  - CategoricalDimensionField:
                      Column:
                        ColumnName: clientip
                        DataSetIdentifier: waf_logs_antiddos_least_fields_v2
                      FieldId: a286b2f7-8acf-4e80-8034-93bedf5e8aa7.clientip.1.1702543709262
                  Values: []
              SortConfiguration:
                FieldSortOptions: []
              TableOptions:
                CellStyle: {}
                CollapsedRowDimensionsVisibility: HIDDEN
                ColumnHeaderStyle: {}
                RowAlternateColorOptions:
                  Status: DISABLED
              TotalOptions:
                ColumnTotalOptions:
                  Placement: END
                RowSubtotalOptions:
                  CustomLabel: <<$aws:subtotalDimension>> Subtotal
                  MetricHeaderCellStyle: {}
                  TotalCellStyle: {}
                  TotalsVisibility: VISIBLE
                  ValueCellStyle: {}
                RowTotalOptions:
                  Placement: AUTO
            Subtitle:
              Visibility: VISIBLE
            Title:
              FormatText:
                RichText: "<visual-title>\n  <b>BaseLine :</b>\n  \_Records combined by\
                  \ URI, Country and Client IP\n</visual-title>"
              Visibility: VISIBLE
            VisualId: f610f253-ecdd-4a90-ae9f-1b7ba4a88750
        - PivotTableVisual:
            Actions: []
            ChartConfiguration:
              FieldOptions:
                DataPathOptions: []
                SelectedFieldOptions:
                - FieldId: a286b2f7-8acf-4e80-8034-93bedf5e8aa7.uri.0.1702543675900
                  Visibility: VISIBLE
                - FieldId: a286b2f7-8acf-4e80-8034-93bedf5e8aa7.uri.1.1702546565763
                  Visibility: VISIBLE
              FieldWells:
                PivotTableAggregatedFieldWells:
                  Columns: []
                  Rows:
                  - CategoricalDimensionField:
                      Column:
                        ColumnName: uri
                        DataSetIdentifier: waf_logs_antiddos_least_fields_v2
                      FieldId: a286b2f7-8acf-4e80-8034-93bedf5e8aa7.uri.0.1702543675900
                  Values:
                  - CategoricalMeasureField:
                      AggregationFunction: COUNT
                      Column:
                        ColumnName: uri
                        DataSetIdentifier: waf_logs_antiddos_least_fields_v2
                      FieldId: a286b2f7-8acf-4e80-8034-93bedf5e8aa7.uri.1.1702546565763
              SortConfiguration:
                FieldSortOptions:
                - FieldId: a286b2f7-8acf-4e80-8034-93bedf5e8aa7.uri.1.1702546565763
                  SortBy:
                    DataPath:
                      Direction: DESC
                      SortPaths: []
              TableOptions:
                CellStyle: {}
                ColumnHeaderStyle: {}
                RowAlternateColorOptions:
                  Status: DISABLED
              TotalOptions:
                RowSubtotalOptions:
                  CustomLabel: <<$aws:subtotalDimension>> Subtotal
                  MetricHeaderCellStyle: {}
                  TotalCellStyle: {}
                  TotalsVisibility: VISIBLE
                  ValueCellStyle: {}
            Subtitle:
              Visibility: VISIBLE
            Title:
              FormatText:
                RichText: |-
                  <visual-title>
                    <b>Event</b>
                    :  Records by URI
                  </visual-title>
              Visibility: VISIBLE
            VisualId: 707522af-7cc8-4831-bf16-cadc910bfd93
        - PivotTableVisual:
            Actions: []
            ChartConfiguration:
              FieldOptions:
                DataPathOptions: []
                SelectedFieldOptions:
                - FieldId: a286b2f7-8acf-4e80-8034-93bedf5e8aa7.uri.0.1702546519078
                  Visibility: VISIBLE
                - FieldId: a286b2f7-8acf-4e80-8034-93bedf5e8aa7.uri.1.1702546549582
                  Visibility: VISIBLE
              FieldWells:
                PivotTableAggregatedFieldWells:
                  Columns: []
                  Rows:
                  - CategoricalDimensionField:
                      Column:
                        ColumnName: uri
                        DataSetIdentifier: waf_logs_antiddos_least_fields_v2
                      FieldId: a286b2f7-8acf-4e80-8034-93bedf5e8aa7.uri.0.1702546519078
                  Values:
                  - CategoricalMeasureField:
                      AggregationFunction: COUNT
                      Column:
                        ColumnName: uri
                        DataSetIdentifier: waf_logs_antiddos_least_fields_v2
                      FieldId: a286b2f7-8acf-4e80-8034-93bedf5e8aa7.uri.1.1702546549582
              SortConfiguration:
                FieldSortOptions:
                - FieldId: a286b2f7-8acf-4e80-8034-93bedf5e8aa7.uri.1.1702546549582
                  SortBy:
                    DataPath:
                      Direction: DESC
                      SortPaths: []
              TableOptions:
                CellStyle: {}
                ColumnHeaderStyle: {}
                MetricPlacement: COLUMN
                RowAlternateColorOptions:
                  Status: DISABLED
              TotalOptions:
                RowSubtotalOptions:
                  CustomLabel: <<$aws:subtotalDimension>> Subtotal
                  MetricHeaderCellStyle: {}
                  TotalCellStyle: {}
                  TotalsVisibility: VISIBLE
                  ValueCellStyle: {}
            Subtitle:
              Visibility: VISIBLE
            Title:
              FormatText:
                RichText: |-
                  <visual-title>
                    <b>Baseline</b>
                    :  Records by URI
                  </visual-title>
              Visibility: VISIBLE
            VisualId: 19faa481-7324-4dd7-a40e-f6108c662bf2
      - ContentType: INTERACTIVE
        FilterControls:
        - Dropdown:
            DisplayOptions:
              SelectAllOptions:
                Visibility: VISIBLE
            FilterControlId: 565da9e4-8d6d-4c40-9527-b0c22c780015
            SourceFilterId: af3150bb-29d4-44b5-88c1-a8f60b3e9d05
            Title: httpsourcename equals
            Type: MULTI_SELECT
        Layouts:
        - Configuration:
            GridLayout:
              CanvasSizeOptions:
                ScreenCanvasSizeOptions:
                  OptimizedViewPortWidth: 1600px
                  ResizeOption: FIXED
              Elements:
              - ColumnIndex: 0
                ColumnSpan: 31
                ElementId: 947b5372-9df5-4453-86dc-ff5beea846e2
                ElementType: TEXT_BOX
                RowIndex: 0
                RowSpan: 3
              - ColumnIndex: 0
                ColumnSpan: 13
                ElementId: 1b234605-7ad4-4c2a-9552-3f8fafaf0ace
                ElementType: VISUAL
                RowIndex: 3
                RowSpan: 9
              - ColumnIndex: 13
                ColumnSpan: 13
                ElementId: 512bdde9-4f03-436c-bbf2-de5988750035
                ElementType: VISUAL
                RowIndex: 3
                RowSpan: 9
              - ColumnIndex: 0
                ColumnSpan: 13
                ElementId: c9198fc5-327e-4a0f-8ac2-ffe04afb369f
                ElementType: VISUAL
                RowIndex: 12
                RowSpan: 7
              - ColumnIndex: 13
                ColumnSpan: 13
                ElementId: 12ea68b7-70c9-4ff8-a1a7-980d3a59d8ac
                ElementType: VISUAL
                RowIndex: 12
                RowSpan: 7
        Name: ja3fingerprint_insights
        ParameterControls:
        - DateTimePicker:
            DisplayOptions:
              DateTimeFormat: YYYY/MM/DD HH:mm:ss
              TitleOptions:
                FontConfiguration:
                  FontSize:
                    Relative: MEDIUM
                Visibility: VISIBLE
            ParameterControlId: da1dbce2-e3f4-46cd-94c7-48b7514a3f60
            SourceParameterName: BaseLineStart
            Title: BaseLine Start
        - DateTimePicker:
            DisplayOptions:
              DateTimeFormat: YYYY/MM/DD HH:mm:ss
              TitleOptions:
                FontConfiguration:
                  FontSize:
                    Relative: MEDIUM
                Visibility: VISIBLE
            ParameterControlId: 6feff8be-71e4-46d4-880d-119659613a1e
            SourceParameterName: BaseLineEnd
            Title: BaseLine End
        - DateTimePicker:
            DisplayOptions:
              DateTimeFormat: YYYY/MM/DD HH:mm:ss
              TitleOptions:
                FontConfiguration:
                  FontSize:
                    Relative: MEDIUM
                Visibility: VISIBLE
            ParameterControlId: 2b823a05-b559-420c-9b84-146c924611b3
            SourceParameterName: EventStart
            Title: Event Start
        - DateTimePicker:
            DisplayOptions:
              DateTimeFormat: YYYY/MM/DD HH:mm:ss
              TitleOptions:
                FontConfiguration:
                  FontSize:
                    Relative: MEDIUM
                Visibility: VISIBLE
            ParameterControlId: 64f58d1d-01e7-465b-8cb6-904ac6b20f7b
            SourceParameterName: EventEnd
            Title: Event End
        - Dropdown:
            DisplayOptions:
              SelectAllOptions:
                Visibility: VISIBLE
              TitleOptions:
                FontConfiguration:
                  FontSize:
                    Relative: MEDIUM
                Visibility: VISIBLE
            ParameterControlId: a611ab74-f856-4f59-b811-053a9ca1b005
            SourceParameterName: AccountID
            Title: Account ID
            Type: MULTI_SELECT
        SheetControlLayouts:
        - Configuration:
            GridLayout:
              Elements:
              - ColumnSpan: 2
                ElementId: da1dbce2-e3f4-46cd-94c7-48b7514a3f60
                ElementType: PARAMETER_CONTROL
                RowSpan: 1
              - ColumnSpan: 2
                ElementId: 6feff8be-71e4-46d4-880d-119659613a1e
                ElementType: PARAMETER_CONTROL
                RowSpan: 1
              - ColumnSpan: 2
                ElementId: 2b823a05-b559-420c-9b84-146c924611b3
                ElementType: PARAMETER_CONTROL
                RowSpan: 1
              - ColumnSpan: 2
                ElementId: 64f58d1d-01e7-465b-8cb6-904ac6b20f7b
                ElementType: PARAMETER_CONTROL
                RowSpan: 1
              - ColumnSpan: 2
                ElementId: a611ab74-f856-4f59-b811-053a9ca1b005
                ElementType: PARAMETER_CONTROL
                RowSpan: 1
              - ColumnSpan: 2
                ElementId: 565da9e4-8d6d-4c40-9527-b0c22c780015
                ElementType: FILTER_CONTROL
                RowSpan: 1
        SheetId: 84653b0c-13fc-4cf6-bef0-bbb1f840c6b7
        TextBoxes:
        - Content: |-
            <text-box>
              The following sections representes the details of  ja3fingerprint and the combination with the country.  The Graphs on the right represent the Event traffic, this to help you compare quickly the traffic pattern between your expected type of traffic and the malicious one. You can set the timestamp of both Basline and Event in the controls files on the top of the current sheet (
              <b>BaselineStart, BaselineEnd, EventStart, EventEnd</b>
              ). For more information about AWS WAF logs field, please check this link
              <a href="https://docs.aws.amazon.com/waf/latest/developerguide/logging-fields.html" target="_blank">https://docs.aws.amazon.com/waf/latest/developerguide/logging-fields.html</a>
            </text-box>
          SheetTextBoxId: 947b5372-9df5-4453-86dc-ff5beea846e2
        Visuals:
        - PivotTableVisual:
            Actions: []
            ChartConfiguration:
              FieldOptions:
                SelectedFieldOptions:
                - FieldId: a286b2f7-8acf-4e80-8034-93bedf5e8aa7.ja3fingerprint.1.1702543810839
                  Visibility: VISIBLE
                - FieldId: a286b2f7-8acf-4e80-8034-93bedf5e8aa7.country.2.1702543826559
                  Visibility: VISIBLE
                - FieldId: a286b2f7-8acf-4e80-8034-93bedf5e8aa7.ja3fingerprint.3.1702547032863
                  Visibility: VISIBLE
              FieldWells:
                PivotTableAggregatedFieldWells:
                  Columns:
                  - CategoricalDimensionField:
                      Column:
                        ColumnName: country
                        DataSetIdentifier: waf_logs_antiddos_least_fields_v2
                      FieldId: a286b2f7-8acf-4e80-8034-93bedf5e8aa7.country.2.1702543826559
                  Rows:
                  - CategoricalDimensionField:
                      Column:
                        ColumnName: ja3fingerprint
                        DataSetIdentifier: waf_logs_antiddos_least_fields_v2
                      FieldId: a286b2f7-8acf-4e80-8034-93bedf5e8aa7.ja3fingerprint.1.1702543810839
                  Values:
                  - CategoricalMeasureField:
                      AggregationFunction: COUNT
                      Column:
                        ColumnName: ja3fingerprint
                        DataSetIdentifier: waf_logs_antiddos_least_fields_v2
                      FieldId: a286b2f7-8acf-4e80-8034-93bedf5e8aa7.ja3fingerprint.3.1702547032863
              SortConfiguration:
                FieldSortOptions: []
              TableOptions:
                CellStyle: {}
                CollapsedRowDimensionsVisibility: HIDDEN
                ColumnHeaderStyle: {}
                RowAlternateColorOptions:
                  Status: DISABLED
              TotalOptions:
                ColumnTotalOptions:
                  Placement: END
                RowSubtotalOptions:
                  CustomLabel: <<$aws:subtotalDimension>> Subtotal
                  MetricHeaderCellStyle: {}
                  TotalCellStyle: {}
                  TotalsVisibility: VISIBLE
                  ValueCellStyle: {}
                RowTotalOptions:
                  Placement: AUTO
            Subtitle:
              Visibility: VISIBLE
            Title:
              FormatText:
                RichText: "<visual-title>\n  <b>Event :</b>\n  \_Records combined by Ja3fingerprint,\
                  \ Client IP and Country\n</visual-title>"
              Visibility: VISIBLE
            VisualId: 12ea68b7-70c9-4ff8-a1a7-980d3a59d8ac
        - PivotTableVisual:
            Actions: []
            ChartConfiguration:
              FieldOptions:
                SelectedFieldOptions:
                - FieldId: a286b2f7-8acf-4e80-8034-93bedf5e8aa7.ja3fingerprint.1.1702543810839
                  Visibility: VISIBLE
                - FieldId: a286b2f7-8acf-4e80-8034-93bedf5e8aa7.country.2.1702543826559
                  Visibility: VISIBLE
                - FieldId: a286b2f7-8acf-4e80-8034-93bedf5e8aa7.ja3fingerprint.3.1702547028136
                  Visibility: VISIBLE
              FieldWells:
                PivotTableAggregatedFieldWells:
                  Columns:
                  - CategoricalDimensionField:
                      Column:
                        ColumnName: country
                        DataSetIdentifier: waf_logs_antiddos_least_fields_v2
                      FieldId: a286b2f7-8acf-4e80-8034-93bedf5e8aa7.country.2.1702543826559
                  Rows:
                  - CategoricalDimensionField:
                      Column:
                        ColumnName: ja3fingerprint
                        DataSetIdentifier: waf_logs_antiddos_least_fields_v2
                      FieldId: a286b2f7-8acf-4e80-8034-93bedf5e8aa7.ja3fingerprint.1.1702543810839
                  Values:
                  - CategoricalMeasureField:
                      AggregationFunction: COUNT
                      Column:
                        ColumnName: ja3fingerprint
                        DataSetIdentifier: waf_logs_antiddos_least_fields_v2
                      FieldId: a286b2f7-8acf-4e80-8034-93bedf5e8aa7.ja3fingerprint.3.1702547028136
              SortConfiguration:
                FieldSortOptions: []
              TableOptions:
                CellStyle: {}
                CollapsedRowDimensionsVisibility: HIDDEN
                ColumnHeaderStyle: {}
                RowAlternateColorOptions:
                  Status: DISABLED
              TotalOptions:
                ColumnTotalOptions:
                  Placement: END
                RowSubtotalOptions:
                  CustomLabel: <<$aws:subtotalDimension>> Subtotal
                  MetricHeaderCellStyle: {}
                  TotalCellStyle: {}
                  TotalsVisibility: VISIBLE
                  ValueCellStyle: {}
                RowTotalOptions:
                  Placement: AUTO
            Subtitle:
              Visibility: VISIBLE
            Title:
              FormatText:
                RichText: "<visual-title>\n  <b>BaseLine :</b>\n  \_Records combined by\
                  \ Ja3fingerprint, Client IP and Country\n</visual-title>"
              Visibility: VISIBLE
            VisualId: c9198fc5-327e-4a0f-8ac2-ffe04afb369f
        - PivotTableVisual:
            Actions: []
            ChartConfiguration:
              FieldOptions:
                DataPathOptions: []
                SelectedFieldOptions:
                - FieldId: a286b2f7-8acf-4e80-8034-93bedf5e8aa7.ja3fingerprint.0.1702543776683
                  Visibility: VISIBLE
                - FieldId: a286b2f7-8acf-4e80-8034-93bedf5e8aa7.ja3fingerprint.1.1702546623264
                  Visibility: VISIBLE
              FieldWells:
                PivotTableAggregatedFieldWells:
                  Columns: []
                  Rows:
                  - CategoricalDimensionField:
                      Column:
                        ColumnName: ja3fingerprint
                        DataSetIdentifier: waf_logs_antiddos_least_fields_v2
                      FieldId: a286b2f7-8acf-4e80-8034-93bedf5e8aa7.ja3fingerprint.0.1702543776683
                  Values:
                  - CategoricalMeasureField:
                      AggregationFunction: COUNT
                      Column:
                        ColumnName: ja3fingerprint
                        DataSetIdentifier: waf_logs_antiddos_least_fields_v2
                      FieldId: a286b2f7-8acf-4e80-8034-93bedf5e8aa7.ja3fingerprint.1.1702546623264
              SortConfiguration:
                FieldSortOptions:
                - FieldId: a286b2f7-8acf-4e80-8034-93bedf5e8aa7.ja3fingerprint.1.1702546623264
                  SortBy:
                    DataPath:
                      Direction: DESC
                      SortPaths: []
              TableOptions:
                CellStyle: {}
                ColumnHeaderStyle: {}
                RowAlternateColorOptions:
                  Status: DISABLED
              TotalOptions:
                RowSubtotalOptions:
                  CustomLabel: <<$aws:subtotalDimension>> Subtotal
                  MetricHeaderCellStyle: {}
                  TotalCellStyle: {}
                  TotalsVisibility: VISIBLE
                  ValueCellStyle: {}
            Subtitle:
              Visibility: VISIBLE
            Title:
              FormatText:
                RichText: "<visual-title>\n  <b>Event :</b>\n  \_Records by Ja3fingerprint\n\
                  </visual-title>"
              Visibility: VISIBLE
            VisualId: 512bdde9-4f03-436c-bbf2-de5988750035
        - PivotTableVisual:
            Actions: []
            ChartConfiguration:
              FieldOptions:
                DataPathOptions: []
                SelectedFieldOptions:
                - FieldId: a286b2f7-8acf-4e80-8034-93bedf5e8aa7.ja3fingerprint.0.1702543776683
                  Visibility: VISIBLE
                - FieldId: a286b2f7-8acf-4e80-8034-93bedf5e8aa7.ja3fingerprint.1.1702546616304
                  Visibility: VISIBLE
              FieldWells:
                PivotTableAggregatedFieldWells:
                  Columns: []
                  Rows:
                  - CategoricalDimensionField:
                      Column:
                        ColumnName: ja3fingerprint
                        DataSetIdentifier: waf_logs_antiddos_least_fields_v2
                      FieldId: a286b2f7-8acf-4e80-8034-93bedf5e8aa7.ja3fingerprint.0.1702543776683
                  Values:
                  - CategoricalMeasureField:
                      AggregationFunction: COUNT
                      Column:
                        ColumnName: ja3fingerprint
                        DataSetIdentifier: waf_logs_antiddos_least_fields_v2
                      FieldId: a286b2f7-8acf-4e80-8034-93bedf5e8aa7.ja3fingerprint.1.1702546616304
              SortConfiguration:
                FieldSortOptions:
                - FieldId: a286b2f7-8acf-4e80-8034-93bedf5e8aa7.ja3fingerprint.1.1702546616304
                  SortBy:
                    DataPath:
                      Direction: DESC
                      SortPaths: []
              TableOptions:
                CellStyle: {}
                ColumnHeaderStyle: {}
                RowAlternateColorOptions:
                  Status: DISABLED
              TotalOptions:
                RowSubtotalOptions:
                  CustomLabel: <<$aws:subtotalDimension>> Subtotal
                  MetricHeaderCellStyle: {}
                  TotalCellStyle: {}
                  TotalsVisibility: VISIBLE
                  ValueCellStyle: {}
            Subtitle:
              Visibility: VISIBLE
            Title:
              FormatText:
                RichText: "<visual-title>\n  <b>BaseLine :</b>\n  \_Records by Ja3fingerprint\n\
                  </visual-title>"
              Visibility: VISIBLE
            VisualId: 1b234605-7ad4-4c2a-9552-3f8fafaf0ace
      - ContentType: INTERACTIVE
        Layouts:
        - Configuration:
            GridLayout:
              CanvasSizeOptions:
                ScreenCanvasSizeOptions:
                  OptimizedViewPortWidth: 1600px
                  ResizeOption: FIXED
              Elements:
              - ColumnSpan: 9
                ElementId: 5e24f311-4ccb-44bc-b6b8-0483d2723dec
                ElementType: TEXT_BOX
                RowSpan: 6
        Name: Note
        SheetId: c5d0b6f5-e035-44b6-8464-212bfc7e804c
        TextBoxes:
        - Content: <text-box>Dashboard created by Imane ZEROUAL, Sr. Technical Account Manager
            at AWS</text-box>
          SheetTextBoxId: 5e24f311-4ccb-44bc-b6b8-0483d2723dec
        Visuals: []
datasets:
  waf_logs_antiddos_least_fields_v2:
    data:
      DataSetId: 612def5a-b103-4e4d-8c04-a027e6fbe124
      Name: waf_logs_antiddos_least_fields_v2
      PhysicalTableMap:
        1201930c-cc9b-491d-8df9-b5be07a11b3b:
          RelationalTable:
            DataSourceArn: ${athena_datasource_arn}
            Catalog: AwsDataCatalog
            Schema: ${athena_database_name}
            Name: waf_logs_antiddos_view
            InputColumns:
            - Name: account_id
              Type: STRING
            - Name: year
              Type: STRING
            - Name: month
              Type: STRING
            - Name: day
              Type: STRING
            - Name: hour
              Type: STRING
            - Name: minute
              Type: STRING
            - Name: timestamp
              Type: INTEGER
            - Name: ja3fingerprint
              Type: STRING
            - Name: httpsourcename
              Type: STRING
            - Name: httpsourceid
              Type: STRING
            - Name: clientip
              Type: STRING
            - Name: country
              Type: STRING
            - Name: httpmethod
              Type: STRING
            - Name: uri
              Type: STRING
            - Name: http_args
              Type: STRING
            - Name: http_version
              Type: STRING
            - Name: request_id
              Type: STRING
            - Name: hearder_value
              Type: STRING
            - Name: header_name
              Type: STRING
      LogicalTableMap:
        a286b2f7-8acf-4e80-8034-93bedf5e8aa7:
          Alias: waf_logs_antiddos_least_fields_v2
          DataTransforms:
          - CastColumnTypeOperation:
              ColumnName: timestamp
              NewColumnType: DATETIME
          - TagColumnOperation:
              ColumnName: country
              Tags:
              - ColumnGeographicRole: COUNTRY
          - ProjectOperation:
              ProjectedColumns:
              - account_id
              - year
              - month
              - day
              - hour
              - minute
              - timestamp
              - ja3fingerprint
              - httpsourcename
              - httpsourceid
              - clientip
              - country
              - httpmethod
              - uri
              - http_args
              - http_version
              - request_id
              - hearder_value
              - header_name
          Source:
            PhysicalTableId: 1201930c-cc9b-491d-8df9-b5be07a11b3b
      ImportMode: DIRECT_QUERY
    dependsOn:
      views:
      - waf_logs_antiddos_view
views:
  waf_logs_antiddos_view:
    data: |-
      CREATE OR REPLACE VIEW ${athena_database_name}.waf_logs_antiddos_view AS
      SELECT
        partition_0 "Account_ID"
      , partition_4 "Year"
      , partition_5 "month"
      , partition_6 "day"
      , partition_7 "hour"
      , partition_8 "minute"
      , "timestamp"
      , ja3fingerprint
      , httpsourcename
      , httpsourceid
      , HTTPREQUEST.clientip clientip
      , HTTPREQUEST.country country
      , HTTPREQUEST.httpMethod httpMethod
      , httprequest.uri uri
      , httprequest.args http_args
      , httprequest.httpversion http_version
      , httprequest.requestid request_id
      , header.value "hearder_value"
      , header.name "header_name"
      FROM
        awslogs
      , UNNEST(httprequest.headers) t (header)
      WHERE (CAST("concat"("partition_4", '-', "partition_5", '-01') AS date) >= ("date_trunc"('month', current_date) - INTERVAL  '3' MONTH))
